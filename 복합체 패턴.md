# π³ [Design Pattern] Composite Pattern (λ³µν•©μ²΄ ν¨ν„΄)

## π“ 1. μλ„ (Intent)
λ³µν•©μ²΄ ν¨ν„΄μ€ κ°μ²΄λ“¤μ„ **νΈλ¦¬ κµ¬μ΅°**λ΅ κµ¬μ„±ν•μ—¬, λ§μΉ λ‹¨μΌ κ°μ²΄μΈ κ²ƒμ²λΌ λ‹¤λ£° μ μκ² ν•΄μ£Όλ” κµ¬μ΅° λ””μμΈ ν¨ν„΄μ…λ‹λ‹¤. 
ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ νΈλ¦¬λ¥Ό κµ¬μ„±ν•λ” κ°λ³„ κ°μ²΄(λ‹¨μΌμ²΄)μ™€ λ³µν•© κ°μ²΄(λ³µν•©μ²΄)λ¥Ό κµ¬λ¶„ν•μ§€ μ•κ³  **λ™μΌν• μ»΄ν¬λ„νΈ μΈν„°νμ΄μ¤**λ¥Ό ν†µν•΄ κ· μΌν•κ² μ²λ¦¬ν•  μ μλ„λ΅ λ•μµλ‹λ‹¤.

## π― 2. ν•΄κ²°ν•κ³ μ ν•λ” λ¬Έμ 
- μ• ν”λ¦¬μΌ€μ΄μ…μ ν•µμ‹¬ λ¨λΈμ΄ **κ³„μΈµμ μΈ νΈλ¦¬ κµ¬μ΅°** (μ: νμΌ μ‹μ¤ν…, μ΅°μ§λ„, UI μ„μ ― κµ¬μ΅° λ“±)λ¥Ό κ°€μ§ λ• μ μ©ν•©λ‹λ‹¤.
- κ³„μΈµ κµ¬μ΅° λ‚΄μ **λ‹¨μΌμ²΄(μ)**μ™€ **λ³µν•©μ²΄(μƒμ/μ»¨ν…μ΄λ„)**λ¥Ό λ‹¤λ£° λ• κµ¬μƒ ν΄λμ¤(Concrete Class)λ¥Ό μΌμΌμ΄ ν™•μΈν•κ³  λ¶„κΈ° μ²λ¦¬(`if (node instanceof Box)`)ν•΄μ•Ό ν•λ” μ½”λ“μ λ³µμ΅μ„±μ„ μ—†μ• κ³  μ‹¶μ„ λ• μ‚¬μ©ν•©λ‹λ‹¤.

## π’΅ 3. ν•µμ‹¬ κµ¬μ΅° (Structure)
1. **Component (μ»΄ν¬λ„νΈ μΈν„°νμ΄μ¤)**: λ‹¨μΌ μ”μ†(Leaf)μ™€ λ³µν•© μ”μ†(Composite) λ¨λ‘λ¥Ό μ•„μ°λ¥΄λ” κ³µν†µ μΈν„°νμ΄μ¤μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μ¤μ§ μ΄ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄μ„ νΈλ¦¬ λ‚΄μ κ°μ²΄λ“¤κ³Ό μƒνΈμ‘μ©ν•©λ‹λ‹¤.
2. **Leaf (μ)**: μμ‹ μ”μ†κ°€ μ—†λ” λ‹¨μΌ κ°μ²΄μ…λ‹λ‹¤. νΈλ¦¬μ λλ‹¨μ— μ„μΉν•λ©° μ‹¤μ§μ μΈ μµμΆ… μ‘μ—…μ„ μν–‰ν•©λ‹λ‹¤.
3. **Composite (λ³µν•©μ²΄/μ»¨ν…μ΄λ„)**: μμ‹ μ”μ†λ“¤(Leaf λλ” λ λ‹¤λ¥Έ Composite)μ„ λ‚΄λ¶€μ— μ»¬λ ‰μ…μΌλ΅ κ°€μ§€λ” μ”μ†μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μ”μ²­μ„ λ°›μΌλ©΄ μ§μ ‘ μ‘μ—…μ„ λ¨λ‘ μν–‰ν•μ§€ μ•κ³ , κ΄€λ¦¬ μ¤‘μΈ ν•μ„ μμ‹λ“¤μ—κ² μ‘μ—…μ„ **μ„μ„(μ¬κ·€μ  νΈμ¶)**ν•©λ‹λ‹¤.

## β… 4. μ¥λ‹¨μ 
**μ¥μ **
- **λ‹¤ν•μ„±κ³Ό μ¬κ·€**λ¥Ό ν™μ©ν•μ—¬ λ§¤μ° λ³µμ΅ν• νΈλ¦¬ κµ¬μ΅°λ„ ν΄λΌμ΄μ–ΈνΈ μ…μ¥μ—μ„λ” μ•„μ£Ό λ‹¨μν•κ²(λ‹¨μΌ κ°μ²΄λ¥Ό λ‹¤λ£¨λ“―) νΈμ¶ν•λ©° μ‘μ—…ν•  μ μμµλ‹λ‹¤.
- **κ°λ°©-νμ‡„ μ›μΉ™ (OCP)**: μƒλ΅μ΄ μ ν•μ μ(Leaf) κ°μ²΄λ‚ μ»¨ν…μ΄λ„λ¥Ό μ¶”κ°€ν•λ”λΌλ„, ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ‚ κΈ°μ΅΄ κ°μ²΄ νΈλ¦¬μ μ½”λ“λ¥Ό μμ •ν•  ν•„μ” μ—†μ΄ μ‰½κ² ν™•μ¥ν•  μ μμµλ‹λ‹¤.

**λ‹¨μ **
- κΈ°λ¥μ΄λ‚ μ„±κ²©μ΄ λ„λ¬΄ λ‹¤λ¥Έ κ°μ²΄λ“¤μ—κ² κ³µν†µ μΈν„°νμ΄μ¤λ¥Ό κ°•μ ν•΄μ•Ό ν•  κ²½μ°, μΈν„°νμ΄μ¤κ°€ κ³Όλ„ν•κ² μΌλ°ν™”λμ–΄ μ„¤κ³„κ°€ λ¨νΈν•΄μ§ μ μμµλ‹λ‹¤. 

---

## β• 5. μ‹¤λ¬΄ λ°±μ—”λ“ μ μ© λ° μμ‹

### μ‹¤λ¬΄ μ• ν”λ¦¬μΌ€μ΄μ… μ‚¬λ΅€
μ—”ν„°ν”„λΌμ΄μ¦ λ°±μ—”λ“ ν™κ²½μ—μ„ λ³µν•©μ²΄ ν¨ν„΄μ΄ ν­λ„“κ² ν™μ©λ  μ μλ” μμ‹λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:
1. **μ΅°μ§λ„ λ° κ¶ν• κ³„μΈµ κ΄€λ¦¬**: μ‚¬λ‚΄ λ¶€μ„λ‚ μ—­ν• (Role) μ„κ³„λ¥Ό λ‚λ λ•, μµμƒμ„ λ¶€μ„/κ΄€λ¦¬μκ°€ κ΄€λ¦¬ μ¤‘μΈ λ¨λ“  ν•μ„ λ¶€μ„/μ‚¬μ©μλ“¤μ κ¶ν• μ •λ³΄λ‚ μ§€ν‘λ¥Ό μΌκ΄„μ μΌλ΅ μ—°μ‚°Β·μ΅°νν•λ” μ‹μ¤ν…μ— μ ν•©ν•©λ‹λ‹¤.
2. **λ‹¤μ¤‘ κ²°μ /ν• μΈ μ •μ±… μ—°μ‚° λ΅μ§**: μ»¤λ¨Έμ¤ μ„λ²„μ—μ„ λ‹¨μΌ ν• μΈ μ •μ±…(Leaf)κ³Ό μ΄λ“¤μ„ λ¬¶μ€ λ³µν•© ν• μΈ μ •μ±…(Composite) κ·Έλ£Ήμ„ λ™μΌν• `DiscountPolicy` μΈν„°νμ΄μ¤λ΅ λ¬¶μ–΄ λ‹¤ν•μ„±μ„ ν†µν•΄ ν• λ²μ νΈμ¶λ΅ μ „μ²΄ μµμΆ… κ²°μ  κΈμ•΅μ„ λ„μ¶ν•λ” λ° μ”λ‹λ‹¤.
3. **κ³„μΈµν• μΉ΄ν…κ³ λ¦¬ (Category) λ…Έλ“**: μ‡Όν•‘λ°μ μƒν’ μΉ΄ν…κ³ λ¦¬ κ³„μΈµ κµ¬μ΅° (λ€λ¶„λ¥ > μ¤‘λ¶„λ¥ > μ†λ¶„λ¥) λ§µν•‘μ—μ„ ν•μ„ μƒν’ κ°―μλ‚ μ „μ²΄ νλ§¤ κΈμ•΅μ„ ν¬λ…ν•κ² μ§‘κ³„ν•λ” λ° μ‚¬μ©ν•©λ‹λ‹¤.

### π’» μλ°” μ½”λ“ μμ‹: μ‚¬λ‚΄ λ¶€μ„λ³„ κΈ‰μ—¬ κ³„μ‚° μ‹μ¤ν…

κΈ°μ΅΄ μ‹¤λ¬΄ ν™κ²½(ν¨ν„΄ λ―Έμ μ©)μ—μ„ κ°μ²΄λ“¤μ΄ λ¶„λ¦¬λμ–΄ μμ„ λ• μ™ μ μ§€λ³΄μκ°€ νλ“ μ§€λ¥Ό λ³΄μ—¬μ£Όλ©°, λ³µν•©μ²΄ ν¨ν„΄μ„ μ μ©ν–μ„ λ•μ λ³€ν™”(Before & After)λ¥Ό λΉ„κµν•©λ‹λ‹¤.

#### β 1. Before (ν¨ν„΄ λ―Έμ μ©) - λ”μ°ν• OCP μ„λ°μ λ

νμ‚¬ μ΅°μ§λ„μ— μλ§μ€ μ§κµ°(λ°±μ—”λ“, ν”„λ΅ νΈμ—”λ“, λ””μμ΄λ„)κ³Ό μ—¬λ¬ λ³µμ΅ν• λ¶€μ„(λ³Έλ¶€, ν€, ννΈ)λ“¤μ΄ κ°κ° λ¶„λ¦¬λ λ‹¨μΌ κ°μ²΄λ‚ λ¦¬μ¤νΈλ΅ μ΅΄μ¬ν•λ‹¤κ³  κ°€μ •ν•΄λ³΄κ² μµλ‹λ‹¤. κ°κΈ° λ‹¤λ¥Έ ν΄λμ¤λ“¤μ΄λΌ **κΈ‰μ—¬λ¥Ό κ°€μ Έμ¤λ” λ©”μ„λ“λ…(`getBackendSalary`, `getManagerSalary`)λ„ λ‹¤λ¦…λ‹λ‹¤.**

λΉ„μ¦λ‹μ¤ λ΅μ§(μ„λΉ„μ¤ κ³„μΈµ)μ—μ„ μ΄ νμ‚¬ μ „μ²΄μ μ΄κΈ‰μ—¬λ¥Ό κµ¬ν•λ ¤λ©΄ μ–΄λ–»κ² μ§μ•Ό ν• κΉμ”?

```java
public class BasicSalaryClient {
    
    public int calculateCompanyTotalCost(HeadOffice headOffice) {
        int total = 0;

        // 1. λ³Έμ‚¬ λ§¤λ‹μ €λ“¤ κΈ‰μ—¬ ν•©μ‚° (λ©”μ„λ“: getManagerSalary)
        for (Manager manager : headOffice.getHeadManagers()) {
            total += manager.getManagerSalary();
        }

        // 2. λ³Έμ‚¬ μ‚°ν• λ°±μ—”λ“ ν€ μμ‚° ν•©μ‚° (λ©”μ„λ“: getBackendTeamBudget)
        for (BackendTeam team : headOffice.getBackendTeams()) {
            // ν€ λ‚΄λ¶€μ—μ„λ” λ°±μ—”λ“ κ°λ°μλ“¤μ getBackendSalary() λ¥Ό λ‹¤μ‹ νΈμ¶ν•κ³  μμ 
            total += team.getBackendTeamBudget();
        }

        // π¨ λ”μ°ν• λ‹¨μ  π¨
        // λ§μ•½ λ‚΄μΌ νμ‚¬μ— 'ν”„λ΅ νΈμ—”λ“ ν€', 'λ°μ΄ν„° λ³Έλ¶€'κ°€ λ μ¶”κ°€λλ‹¤λ©΄?
        // μ΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ°‘μ— forλ¬Έ λ¶„κΈ°λ“¤μ„ κ³„μ† μ¶”κ°€ν•΄μ„ μλ™ κ³„μ‚° μ½”λ“λ¥Ό λ μ‘μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
        // for (FrontendTeam feTeam : headOffice.getFrontendTeams()) { ... }
        
        return total;
    }
}
```

#### β… 2. After (λ³µν•©μ²΄ ν¨ν„΄ μ μ©) - μ„μ„κ³Ό μ¬κ·€μ λ§λ²•

λ¨λ“  μ§κµ°(λ°±μ—”λ“ λ‹΄λ‹Ή, λ””μμΈ λ‹΄λ‹Ή)κ³Ό λ¨λ“  λ¶€μ„ κ·Έλ£Ή(λ³Έμ‚¬, λ°±μ—”λ“ν€, λ””μμΈν€ λ“±)μ„ **λ¨λ‘ κ³µν†µ `PayableNode`λΌλ” λ™μΌ μΈν„°νμ΄μ¤(`Component`) λ’¤μ— μ¨κ²¨μ„ ν•λ‚λ΅ μ·¨κΈ‰**ν•©λ‹λ‹¤. `getCost()`λΌλ” ν†µμΌλ λ©”μ„λ“λ¥Ό κ°•μ ν•©λ‹λ‹¤.

```java
// 1. Component (κ³µν†µ μΈν„°νμ΄μ¤)
interface PayableNode {
    int getCost(); // λ‹¨μΌ μ§μ›μ΄λ“  λ¶€μ„λ“  κ°„μ— "λ„¤κ°€ κ°€μ§„ λΉ„μ©"μ„ λ°ν™ν•λΌ.
}

// 2. Leaf (λ‹¨μΌ κ°μ²΄λ“¤: κ° ννΈλ³„ μ§μ›)
class BackendDeveloper implements PayableNode {
    private int salary;
    public BackendDeveloper(int salary) { this.salary = salary; }
    @Override public int getCost() { return salary; }
}

class FrontendDeveloper implements PayableNode {
    private int salary;
    public FrontendDeveloper(int salary) { this.salary = salary; }
    @Override public int getCost() { return salary; }
}

// 3. Composite (λ³µν•© κ°μ²΄λ“¤: μ—¬λ¬ ν€, λ¶€μ„)
class DevelopmentTeam implements PayableNode {
    // β­οΈ μ§μ›μ΄λ“  λ§¤λ‹μ €λ“ , λ‚μ¤‘μ— μ¶”κ°€λ  λ‹¤λ¥Έ ν€(ν•μ„ ννΈ)μ΄λ“  
    // λ™μΌν• κ³µν†µ μΈν„°νμ΄μ¤ λ°°μ—΄(List<PayableNode>) ν•λ‚λ΅ λ¨λ‘ μμ©ν•©λ‹λ‹¤!
    private List<PayableNode> members = new ArrayList<>();
    
    public void addMember(PayableNode node) { members.add(node); }

    @Override
    public int getCost() {
        int sum = 0;
        // π’« λ‚΄λ¶€μ— λ“¤μ–΄μλ” κ² λ§¤λ‹μ €(Leaf)μΈμ§€, λ λ‹¤λ¥Έ ν”„λ΅ νΈμ—”λ“ ν•μ„ ννΈ(Composite)μΈμ§€ μ• ν•„μ” μ—†μ΄ getCost() ν•λ‚λ΅ μ„μ„!
        for (PayableNode node : members) {
            // λ§μ•½ nodeκ°€ ν•μ„ ννΈ(Composite)λΌλ©΄ μ € μ•μ—μ„ μ•μ•„μ„ λ‹¤μ‹ λ£¨ν”„(μ¬κ·€)κ°€ λκ² λ©λ‹λ‹¤.
            sum += node.getCost(); 
        }
        return sum;
    }
}

// 4. Client (λΉ„μ¦λ‹μ¤ μ‹¤ν–‰ λ΅μ§ μ—­ν• )
public class CompositeSalaryClient {
    
    // μ΄ λ©”μ„λ“ ν•λ‚λ©΄ μ΄κΈ‰μ—¬κ°€ μ „λ¶€ κ³„μ‚°λ©λ‹λ‹¤!
    public int calculateCompanyTotalCost(PayableNode rootNode) {
        
        // π λ§λ²• κ°™μ€ κ²°λ΅ !
        // νλΌλ―Έν„°λ΅ λ„μ–΄μ¨ rootNodeκ°€ 'λ³Έμ‚¬'μ΄λ“  'λ°±μ—”λ“ν€'μ΄λ“  μ–΄λ–¤ λ…Έλ“λ“  μƒκ΄€μ—†μ΄ λ™μ‘ν•©λ‹λ‹¤.
        // λ‚΄μΌ ν”„λ΅ νΈμ—”λ“ ν€, μΈμ‚¬ν€μ΄ μƒλ΅­κ² μ¶”κ°€λμ–΄λ„ μ΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ‹¨ 1μ¤„λ„ μμ •λ  ν•„μ”κ°€ μ—†μµλ‹λ‹¤. (OCP μ¤€μ)
        
        return rootNode.getCost();
    }
}
```

#### βοΈ μμ‹μ ν•µμ‹¬ μ •λ¦¬
- κΈ°μ΅΄(Before)μ—λ” λ¦¬μ¤νΈλ¥Ό μ—¬λ¬ κ° λ¶λ¬μ™€μ„(λ°±μ—”λ“ λ¦¬μ¤νΈ, λ§¤λ‹μ € λ¦¬μ¤νΈ λ“±) λ£¨ν”„λ¥Ό λλ¦¬κ³ , κ·Έ μ•μ΄ λ ν€μ΄λ©΄ μ¬κ·€λ¥Ό λ”°λ΅ λλ ¤μ•Ό ν–μΌλ©°, `getSalary`, `getBudget` λ“± λ©”μ„λ“ λ„¤μ΄λ° μ°¨μ΄κΉμ§€ κ°λ³„μ μΌλ΅ λ€μ‘ν•΄ μ¤μ•Ό(λ¶„κΈ° μ²λ¦¬) ν–μµλ‹λ‹¤.
- ν•μ§€λ§ **λ³µν•©μ²΄ ν¨ν„΄**μ„ μ‚¬μ©ν•λ©΄:
  - **`PayableNode` (Component)**: λ¨λ“  κ°μ²΄λ¥Ό κ°μ‹Έλ” ν†µμΌ κ·κ²©. λ‹¨μΌ λ…Έλ“μΈμ§€ κ·Έλ£Ή λ…Έλ“μΈμ§€ μ¶”μƒν™”ν•©λ‹λ‹¤.
  - **`BackendDeveloper` (Leaf)**: λ‚΄λ¶€ μ”μ†κ°€ μ—†λ” μΆ…λ‹¨. μκ°€ κ°’λ§ λ°ν™.
  - **`DevelopmentTeam` (Composite)**: λ‚΄λ¶€ μ»¬λ ‰μ…(`List<PayableNode>`)μ„ κ°€μ Έ μ”μ†μ™€ κ·Έλ£Ή μ–‘μ½ λ‹¤ μ°¨λ³„ μ—†μ΄(`addMember`) μ¶”κ°€ν•  μ μκ³ , λ‚΄λ¶€ κ·Έλ£Ή μ†μΌλ΅ μ¬κ·€κ°€ μλ™ μ„μ„λ©λ‹λ‹¤.
  - **κ²°κ³Ό**: `rootNode.getCost()` ν• μ¤„ νΈμ¶λ§μΌλ΅ λ‚΄λ¶€ νƒ€μ… λΉ„κµμ™€ λ”μ°ν• λ¶„κΈ°λ¬Έ(`if instanceof`) μ—†μ΄ μ „μ²΄ κµ¬μ΅°λ¥Ό μνν•κ² λ©λ‹λ‹¤.
